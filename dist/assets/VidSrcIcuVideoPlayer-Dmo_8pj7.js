const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/streamingService-jLzF5W_z.js","assets/index-CZSZZV6j.js","assets/index-BP79qFqv.css"])))=>i.map(i=>d[i]);
import{r,j as t,B as ne,C as ce,F as re,D as se,s as le,E as ae,_ as de}from"./index-CZSZZV6j.js";import{W as M}from"./watchHistory-BPNt32Ju.js";const me=({source:p,title:P,onClose:I,isOpen:g,mediaItem:d,mediaType:a,season:v,episode:x,onNextEpisode:S})=>{if(!p)return null;const[f,A]=r.useState(0),[j,U]=r.useState([p]),[C,y]=r.useState(!1),[m,V]=r.useState(!1),[k,F]=r.useState(!1),[q,T]=r.useState(1),[R,N]=r.useState(0),[h,X]=r.useState(0),[G,B]=r.useState(!0),c=r.useRef(null),E=r.useRef(void 0),u=r.useRef(void 0),b=r.useRef(null),J=r.useRef(null);r.useEffect(()=>{if(!g)return;console.log("ðŸš« VidSrc.icu Player - Initializing minimal popup blocking");const n=/iPhone|iPad|iPod|Android|Mobile/i.test(navigator.userAgent);n&&console.log("ðŸ“± VidSrc.icu - Mobile device detected, using minimal blocking for compatibility");const i=window.open,w=window.alert,L=window.confirm,oe=window.prompt,_=document.write;window.open=function(...o){return console.log("ðŸš« VidSrc.icu - Blocked popup attempt:",o[0]),null},window.alert=function(o){console.log("ðŸš« VidSrc.icu - Blocked alert:",o)},window.confirm=function(o){return console.log("ðŸš« VidSrc.icu - Blocked confirm:",o),!1},window.prompt=function(o){return console.log("ðŸš« VidSrc.icu - Blocked prompt:",o),null},document.write=function(o){if(o&&(o.includes("ad")||o.includes("popup")||o.includes("redirect")||o.includes("aclib")||o.includes("histats")||o.includes("acscdn")||o.includes("vidsrc.icu")||o.includes("analytics")||o.includes("tracking"))){console.log("ðŸš« VidSrc.icu - Blocked document.write with ad content");return}return _.call(document,o)};try{const o=window.location.assign,s=window.location.replace;window.location.assign=function(e){return e.includes("ads")||e.includes("popup")||e.includes("redirect")||e.includes("promo")||e.includes("offer")||e.includes("casino")||e.includes("betting")||e.includes("dating")||e.includes("adult")||e.includes("doubleclick")||e.includes("googlesyndication")||e.includes("facebook.com/tr")||e.includes("googletagmanager")?(console.log("ðŸš« VidSrc.icu - Blocked ad redirect:",e),!1):(console.log("âœ… VidSrc.icu - Allowing legitimate navigation:",e),o.call(window.location,e))},window.location.replace=function(e){return e.includes("ads")||e.includes("popup")||e.includes("redirect")||e.includes("promo")||e.includes("offer")||e.includes("casino")||e.includes("betting")||e.includes("dating")||e.includes("adult")||e.includes("doubleclick")||e.includes("googlesyndication")||e.includes("facebook.com/tr")||e.includes("googletagmanager")?(console.log("ðŸš« VidSrc.icu - Blocked ad redirect:",e),!1):(console.log("âœ… VidSrc.icu - Allowing legitimate navigation:",e),s.call(window.location,e))}}catch{console.log("ðŸš« VidSrc.icu - Could not override location methods (read-only)")}window.addEventListener("beforeunload",o=>{o.preventDefault(),o.returnValue="",console.log("ðŸš« VidSrc.icu - Blocked beforeunload redirect")});const H=o=>{const s=o.target;s&&(s.tagName==="A"||s.classList.contains("ad")||s.classList.contains("popup")||s.id.includes("ad")||s.className.includes("ad")||s.className.includes("vidsrc"))&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation(),console.log("ðŸš« VidSrc.icu - Blocked suspicious click"))};if(document.addEventListener("click",H,!0),n){const o=s=>{const e=s.target;e&&(e.classList.contains("ad")||e.classList.contains("popup")||e.classList.contains("banner")||e.classList.contains("advertisement")||e.id.includes("ad")||e.id.includes("popup")||e.tagName==="A"&&(e.getAttribute("href")?.includes("ads")||e.getAttribute("href")?.includes("popup")||e.getAttribute("href")?.includes("redirect")||e.getAttribute("href")?.includes("promo")||e.getAttribute("href")?.includes("casino")||e.getAttribute("href")?.includes("betting")))&&(s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation(),console.log("ðŸ“± VidSrc.icu - Blocked mobile ad touch"))};document.addEventListener("touchstart",o,{passive:!1,capture:!0}),document.addEventListener("touchend",o,{passive:!1,capture:!0}),console.log("ðŸ“± VidSrc.icu - Mobile ad blocking enabled")}console.log("ðŸš« VidSrc.icu - Smart ad blocking enabled");const W=window.fetch;return window.fetch=function(o,s){const e=typeof o=="string"?o:o.toString();return["googlesyndication.com","googleadservices.com","doubleclick.net","facebook.com/tr","google-analytics.com","googletagmanager.com","popads.net","popcash.net","propellerads.com","vidsrc.icu/ads","vidsrc.icu/analytics","vidsrc.icu/tracking","outbrain.com","taboola.com","revcontent.com"].some(ie=>e.includes(ie))?(console.log("ðŸš« VidSrc.icu - Blocked ad network request:",e),Promise.reject(new Error("Blocked by ad blocker"))):W.call(window,o,s)},()=>{window.open=i,window.alert=w,window.confirm=L,window.prompt=oe,document.write=_,window.fetch=W,document.removeEventListener("click",H,!0),console.log("ðŸ§¹ VidSrc.icu - Cleaned up popup blocking")}},[g]),r.useEffect(()=>{g&&(async()=>{if(d&&a)try{const{StreamingService:i}=await de(async()=>{const{StreamingService:L}=await import("./streamingService-jLzF5W_z.js");return{StreamingService:L}},__vite__mapDeps([0,1,2])),w=await i.findStreamingSources(d.id.toString(),a,v,x);w.length>0&&U(w)}catch(i){console.error("VidSrc.icu - Failed to load additional sources:",i)}})()},[g,d,a,v,x]);const D=()=>{console.log(`VidSrc.icu - Source ${f} failed, trying next...`),f<j.length-1?(A(f+1),y(!1)):(y(!0),console.log("VidSrc.icu - All sources failed"))},l=j[f]||p;r.useEffect(()=>{if(!g)V(!1),N(0),u.current&&(clearInterval(u.current),u.current=void 0),b.current&&(window.removeEventListener("message",b.current),b.current=null);else if(d&&a){const n=M.getWatchHistory().find(i=>i.id===d.id.toString()&&i.type===a);n&&c.current&&(c.current.currentTime=n.progress,N(n.progress))}},[g,d,a]),r.useEffect(()=>(d&&a&&g&&(p.type==="embed"||m&&h>0&&(u.current=window.setInterval(()=>{c.current&&h>0&&M.updateWatchHistory(d,c.current.currentTime,h,a)},1e4))),!m&&p.type!=="embed"&&u.current&&(clearInterval(u.current),u.current=void 0),()=>{u.current&&(clearInterval(u.current),u.current=void 0)}),[m,d,a,h,P,g,p.type]);const $=()=>{c.current&&(m?c.current.pause():c.current.play(),V(!m))},K=()=>{c.current&&(c.current.muted=!k,F(!k))},Q=n=>{const i=parseFloat(n.target.value);T(i),c.current&&(c.current.volume=i,F(i===0))},Y=()=>{c.current&&N(c.current.currentTime)},Z=()=>{c.current&&X(c.current.duration)},O=n=>{const i=parseFloat(n.target.value);N(i),c.current&&(c.current.currentTime=i)},z=n=>{const i=Math.floor(n/60),w=Math.floor(n%60);return`${i}:${w.toString().padStart(2,"0")}`},ee=()=>{B(!0),E.current&&clearTimeout(E.current),E.current=window.setTimeout(()=>{m&&B(!1)},3e3)},te=()=>{c.current&&(document.fullscreenElement?document.exitFullscreen():c.current.requestFullscreen())};return g?t.jsx("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onMouseMove:ee,children:[t.jsx("button",{onClick:I,className:"absolute top-4 right-4 z-10 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors",children:t.jsx(ne,{className:"w-6 h-6"})}),j.length>1&&t.jsx("div",{className:"absolute top-16 right-4 z-20",children:t.jsx("select",{value:f,onChange:n=>{A(parseInt(n.target.value)),y(!1)},className:"bg-black/70 text-white px-3 py-1 rounded text-sm",children:j.map((n,i)=>t.jsxs("option",{value:i,children:[n.provider," (",n.quality,")"]},i))})}),t.jsx("div",{className:"absolute top-4 left-4 z-10 bg-black/70 text-white px-3 py-2 rounded text-sm",children:"ðŸŽ¬ HD Cinema Player"}),/iPhone|iPad|iPod|Android|Mobile/i.test(navigator.userAgent)&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/90 z-50",children:t.jsxs("div",{className:"text-center text-white p-6",children:[t.jsx("h3",{className:"text-xl mb-4",children:"ðŸ“± Not Available on Mobile"}),t.jsx("p",{className:"mb-4",children:"HD Cinema is not compatible with mobile devices."}),t.jsx("p",{className:"text-sm opacity-75",children:"Please use a desktop browser or try Premium Stream."})]})}),C&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 z-30",children:t.jsxs("div",{className:"text-center text-white",children:[t.jsx("h3",{className:"text-xl mb-4",children:"Media Unavailable"}),t.jsx("p",{className:"mb-4",children:"HD Cinema failed to load this content."}),t.jsx("button",{onClick:()=>{A(0),y(!1)},className:"bg-red-600 hover:bg-red-700 px-4 py-2 rounded",children:"Retry"})]})}),!C&&l.type==="embed"?t.jsx("div",{className:"relative w-full h-full bg-black",children:t.jsx("iframe",{ref:J,src:l.url,className:"w-full h-full border-0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",referrerPolicy:"unsafe-url",title:`${P} - VidSrc.icu Player`,onLoad:()=>{if(console.log("ðŸŽ¬ VidSrc.icu iframe loaded:",l.provider,l.url),console.log("ðŸš« VidSrc.icu - Enhanced popup blocking active"),y(!1),d&&a&&v&&x&&M.updateWatchHistory(d,0,3600,a,v,x,`S${v}E${x}`),a==="tv"&&S){b.current&&window.removeEventListener("message",b.current);const n=i=>{console.log("VidSrc.icu - Received message from iframe:",i.data),i.data&&typeof i.data=="object"&&(i.data.type==="video-ended"||i.data.event==="ended"||i.data.action==="ended"||i.data.message==="video-ended")&&(console.log("VidSrc.icu - Video ended message received, auto-advancing to next episode"),S()),typeof i.data=="string"&&(i.data==="video-ended"||i.data==="ended")&&(console.log("VidSrc.icu - Video ended string message received, auto-advancing to next episode"),S())};b.current=n,window.addEventListener("message",n),console.log("VidSrc.icu - Set up message listener for video end detection")}},onError:n=>{console.error("VidSrc.icu - Iframe failed to load:",l.provider,l.url,n),D()}},`vidsrcicu-${l.provider}-${f}`)}):C?null:t.jsx("video",{ref:c,src:l.url,className:"w-full h-full object-contain",onTimeUpdate:Y,onLoadedMetadata:Z,onPlay:()=>V(!0),onPause:()=>V(!1),onClick:$,onEnded:()=>{console.log("VidSrc.icu - Video ended, checking for next episode"),a==="tv"&&S&&(console.log("VidSrc.icu - Auto-advancing to next episode"),S())},onError:n=>{console.error("VidSrc.icu - Video error:",n),console.error("VidSrc.icu - Video src:",l.url),D()},onLoadStart:()=>console.log("VidSrc.icu - Video load started:",l.url),onCanPlay:()=>console.log("VidSrc.icu - Video can play:",l.url),onLoadedData:()=>console.log("VidSrc.icu - Video data loaded:",l.url),crossOrigin:"anonymous",preload:"metadata"},`vidsrcicu-video-${f}`),l.type!=="embed"&&t.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-6 transition-opacity duration-300 ${G?"opacity-100":"opacity-0"}`,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("input",{type:"range",min:"0",max:h||0,value:R,onChange:O,className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer slider"}),t.jsxs("div",{className:"flex justify-between text-white text-sm mt-1",children:[t.jsx("span",{children:z(R)}),t.jsx("span",{children:z(h)})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("button",{onClick:$,className:"p-2 text-white hover:text-gray-300 transition-colors",children:m?t.jsx(ce,{className:"w-8 h-8"}):t.jsx(re,{className:"w-8 h-8"})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:K,className:"text-white hover:text-gray-300 transition-colors",children:k?t.jsx(se,{className:"w-6 h-6"}):t.jsx(le,{className:"w-6 h-6"})}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:k?0:q,onChange:Q,className:"w-20 h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),t.jsxs("span",{className:"text-white font-medium",children:[P," - VidSrc.icu"]})]}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsx("button",{onClick:te,className:"text-white hover:text-gray-300 transition-colors",children:t.jsx(ae,{className:"w-6 h-6"})})})]})]}),!l.url&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:t.jsxs("div",{className:"text-white text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),t.jsx("p",{children:"Loading VidSrc.icu player..."})]})})]})}):null};export{me as default};
