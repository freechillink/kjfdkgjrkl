import{g as D,d as F,r as n,j as e,L as b,h as u,F as L,b as W,i as E}from"./index-CZSZZV6j.js";import{m as C}from"./tmdb-eNF6KsIk.js";import{StreamingService as R}from"./streamingService-jLzF5W_z.js";import{W as v}from"./watchlist-BX-jt4tO.js";import{W as _}from"./watchHistory-BPNt32Ju.js";import{P as l}from"./providerStorage-CCn93MUr.js";import"./config-CeCXydgj.js";const T=()=>{const{id:i}=D(),y=F(),[t,w]=n.useState(null),[m,c]=n.useState(null),[p,f]=n.useState(!1),[o,x]=n.useState(!1),[d,g]=n.useState(!1),h=n.useRef(null),j=typeof navigator<"u"&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),[a,k]=n.useState(()=>{if(j){const s=l.getValidSelectedProvider();return s==="vidking"||s==="vidsrccc"?s:"vidking"}return l.getValidSelectedProvider()});n.useEffect(()=>{i&&(P(i),x(v.isInWatchlist(i,"movie"))),window.scrollTo(0,0)},[i]),n.useEffect(()=>{const s=r=>{h.current&&!h.current.contains(r.target)&&g(!1)};if(d)return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[d]);const P=async s=>{try{c(null);const r=await C.getDetails(s);w(r)}catch(r){console.error("Error fetching movie details:",r),c("Failed to load movie details. Please try again.")}},S=async()=>{if(!(!i||!t))try{f(!0),console.log("ðŸŽ¬ MovieDetails - Navigating to player page for movie:",i),console.log("ðŸŽ¯ MovieDetails - Selected provider:",a),console.log("ðŸ’¾ MovieDetails - Saved provider from storage:",l.getValidSelectedProvider());const s=await R.findStreamingSources(i,"movie",void 0,void 0,a);if(s&&s.length>0){_.updateWatchHistory(t,60,7200,"movie"),window.dispatchEvent(new Event("refreshContinueWatching"));const r=new URLSearchParams({type:"movie",title:t.title,provider:a});y(`/player/${i}?${r.toString()}`),console.log(`ðŸš€ MovieDetails - Navigating to player with ${s.length} streaming sources`),console.log("ðŸ”— MovieDetails - URL params:",r.toString()),console.log("ðŸŽ¯ MovieDetails - Provider being passed:",a)}else c("ðŸŽ¬ No streaming sources available. Please try again later.")}catch(s){console.error("Error loading stream:",s),c("Failed to load streaming source. Please try again."),f(!1)}},N=s=>s?s.startsWith("http")?s:`https://image.tmdb.org/t/p/w500${s}`:"https://via.placeholder.com/500x750/374151/9CA3AF?text=No+Image",M=s=>{k(s),l.saveSelectedProvider(s),g(!1),console.log("Provider changed to:",s)},A=()=>{!t||!i||(o?v.removeFromWatchlist(i,"movie")&&(x(!1),console.log("Removed from watchlist:",t.title)):v.addToWatchlist(t,"movie")&&(x(!0),console.log("Added to watchlist:",t.title)))};return m?e.jsx("div",{className:"min-h-screen bg-black py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs(b,{to:"/",className:"inline-flex items-center text-white hover:text-gray-300 mb-6",children:[e.jsx(u,{className:"mr-2"}),"Back to Home"]}),e.jsx("div",{className:"bg-red-900 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-200",children:m})})]})})]})}):t?e.jsxs("div",{className:"min-h-screen bg-black",children:[e.jsxs("div",{className:"relative min-h-screen sm:min-h-[90vh] md:min-h-screen",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:N(t.backdrop_path||t.poster_path||""),alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black via-black/80 to-black/40"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/20"})]}),e.jsx("div",{className:"absolute top-4 sm:top-6 md:top-8 left-4 sm:left-6 md:left-8 z-20 safe-area-inset-top",children:e.jsxs(b,{to:"/",className:"inline-flex items-center text-white hover:text-gray-300 active:text-gray-400 transition-colors bg-black/50 backdrop-blur-sm px-3 sm:px-4 py-2 sm:py-2.5 rounded-full touch-manipulation min-h-[44px]",children:[e.jsx(u,{className:"mr-2 w-5 h-5"}),e.jsx("span",{className:"text-base font-medium",children:"Back"})]})}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 md:px-8 py-8 pt-20 sm:pt-24 md:pt-28",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:gap-12",children:[e.jsx("div",{className:"flex-shrink-0 flex justify-center md:justify-start",children:e.jsx("img",{src:N(t.poster_path||""),alt:t.title,className:"w-56 h-80 sm:w-64 sm:h-96 md:w-72 md:h-[432px] object-cover rounded-lg shadow-2xl"})}),e.jsxs("div",{className:"flex-1 text-white text-center md:text-left",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 sm:mb-6 leading-tight",children:t.title}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 sm:gap-6 mb-6 text-base sm:text-lg",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-green-400 font-semibold",children:[Math.round(t.vote_average*10),"% Match"]})}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:new Date(t.release_date).getFullYear()})}),t.runtime&&e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{children:[Math.floor(t.runtime/60),"h ",t.runtime%60,"m"]})})]}),t.genres&&t.genres.length>0&&e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2 sm:gap-3 justify-center md:justify-start",children:t.genres.map(s=>e.jsx("span",{className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-white/20 backdrop-blur-sm rounded-full text-sm sm:text-base font-medium",children:s.name},s.id))})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-semibold mb-4 text-center md:text-left",children:"Overview"}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl leading-relaxed text-gray-200 text-center md:text-left max-w-4xl",children:t.overview||"No overview available."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center md:justify-start",children:[e.jsxs("button",{onClick:S,disabled:p,className:"flex items-center justify-center px-8 sm:px-10 py-3 sm:py-4 bg-white text-black hover:bg-gray-200 active:bg-gray-300 disabled:bg-gray-400 disabled:text-gray-600 font-bold rounded-lg transition-all duration-200 transform active:scale-95 min-h-[48px] sm:min-h-[52px] shadow-lg touch-manipulation",children:[e.jsx(L,{className:"mr-3 w-5 h-5 sm:w-6 sm:h-6"}),e.jsx("span",{className:"text-base sm:text-lg font-semibold",children:p?"Loading...":"Play"})]}),e.jsxs("button",{onClick:A,className:`flex items-center justify-center px-8 sm:px-10 py-3 sm:py-4 font-bold rounded-lg transition-all duration-200 transform active:scale-95 min-h-[48px] sm:min-h-[52px] backdrop-blur-sm touch-manipulation ${o?"bg-[#e50914] hover:bg-[#b8070f] active:bg-[#a00610] text-white shadow-lg":"bg-gray-600/70 hover:bg-gray-500/80 active:bg-[#e50914] text-white"}`,children:[!o&&e.jsx(W,{className:"mr-3 w-5 h-5 sm:w-6 sm:h-6"}),e.jsx("span",{className:"text-base sm:text-lg font-semibold",children:o?"In My List âœ“":"Add to My List"})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-4 text-center md:text-left text-white",children:"Select Streaming Provider"}),e.jsxs("div",{className:"relative",ref:h,children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),g(!d)},className:"w-full sm:w-auto flex items-center justify-between px-6 py-3 bg-gray-800/80 hover:bg-gray-700/80 active:bg-gray-600/80 text-white rounded-lg backdrop-blur-sm border border-gray-600/50 transition-all duration-200 min-h-[48px] touch-manipulation",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${a==="vidking"?"bg-red-500":a==="vidsrccc"?"bg-blue-500":a==="vidsrcxyz"?"bg-cyan-500":a==="vidlink"?"bg-green-500":a==="vidsrcicu"?"bg-purple-500":a==="vidsrcto"?"bg-orange-500":a==="autoembed"?"bg-yellow-500":a==="2embed"?"bg-pink-500":"bg-gray-500"}`}),e.jsxs("span",{className:"text-base font-medium",children:[l.getAvailableProviders().find(s=>s.id===a)?.name||"Premium Stream"," (",l.getAvailableProviders().find(s=>s.id===a)?.quality||"1080p",")"]})]}),e.jsx(E,{className:`w-5 h-5 transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800/95 backdrop-blur-sm border border-gray-600/50 rounded-lg shadow-2xl z-50 overflow-hidden",children:(j?l.getMobileProviders():l.getAvailableProviders()).map(s=>e.jsxs("button",{onClick:r=>{r.stopPropagation(),M(s.id)},className:`w-full flex items-center px-6 py-4 text-left hover:bg-gray-700/80 active:bg-gray-600/80 transition-colors duration-200 touch-manipulation ${a===s.id?"bg-gray-700/60":""}`,children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${s.id==="vidking"?"bg-red-500":s.id==="vidsrccc"?"bg-blue-500":s.id==="vidsrcxyz"?"bg-cyan-500":s.id==="vidlink"?"bg-green-500":s.id==="vidsrcicu"?"bg-purple-500":s.id==="vidsrcto"?"bg-orange-500":s.id==="autoembed"?"bg-yellow-500":s.id==="2embed"?"bg-pink-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium text-base",children:s.name}),e.jsxs("div",{className:"text-gray-400 text-sm",children:[s.quality," â€¢ ",s.adBlockFriendly?"Ad-block friendly":"May have ads"]})]}),a===s.id&&e.jsx("div",{className:"ml-auto w-2 h-2 bg-red-500 rounded-full"})]},s.id))})]}),e.jsx("div",{className:"mt-4 p-4 bg-gray-800/40 rounded-lg backdrop-blur-sm border border-gray-600/30",children:e.jsxs("p",{className:"text-gray-300 text-sm text-center md:text-left",children:[e.jsx("span",{className:"font-medium",children:"Selected:"})," ",l.getAvailableProviders().find(s=>s.id===a)?.name,e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{className:"text-green-400",children:l.getAvailableProviders().find(s=>s.id===a)?.quality}),l.getAvailableProviders().find(s=>s.id===a)?.adBlockFriendly&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("span",{className:"text-blue-400",children:"Ad-block friendly"})]})]})})]}),m&&e.jsx("div",{className:"mt-6 p-4 bg-red-900/50 border border-red-600/50 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-200 text-center text-base",children:m})})]})]})})]}),e.jsx("div",{className:"px-3 mobile:px-4 md:px-8 lg:px-16 py-8 mobile:py-12",children:e.jsxs("div",{className:"max-w-4xl",children:[t.genres&&t.genres.length>0&&e.jsx("div",{className:"mb-6 mobile:mb-8",children:e.jsx("div",{className:"flex flex-wrap gap-2 justify-center md:justify-start",children:t.genres.map(s=>e.jsx("span",{className:"text-white text-xs mobile:text-sm px-2 mobile:px-3 py-1 border border-gray-600 rounded-full",children:s.name},s.id))})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mobile:gap-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h2",{className:"text-white text-xl mobile:text-2xl font-semibold mb-3 mobile:mb-4 text-center md:text-left",children:["About ",t.title]}),e.jsx("div",{className:"text-gray-300 space-y-3 mobile:space-y-4",children:e.jsx("p",{className:"text-sm mobile:text-base leading-relaxed text-center md:text-left",children:t.overview||"No overview available."})})]}),e.jsxs("div",{className:"space-y-3 mobile:space-y-4",children:[e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("span",{className:"text-gray-400 text-xs mobile:text-sm",children:"Release year: "}),e.jsx("span",{className:"text-white text-sm mobile:text-base",children:new Date(t.release_date).getFullYear()})]}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("span",{className:"text-gray-400 text-xs mobile:text-sm",children:"Rating: "}),e.jsxs("span",{className:"text-white text-sm mobile:text-base",children:[t.vote_average.toFixed(1),"/10"]})]}),t.runtime&&e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("span",{className:"text-gray-400 text-xs mobile:text-sm",children:"Duration: "}),e.jsxs("span",{className:"text-white text-sm mobile:text-base",children:[Math.floor(t.runtime/60),"h ",t.runtime%60,"m"]})]}),t.production_companies&&t.production_companies.length>0&&e.jsxs("div",{className:"text-center md:text-left",children:[e.jsx("span",{className:"text-gray-400 text-xs mobile:text-sm",children:"Production: "}),e.jsx("span",{className:"text-white text-sm mobile:text-base",children:t.production_companies.slice(0,2).map(s=>s.name).join(", ")})]})]})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-black",children:e.jsxs("div",{className:"relative min-h-screen sm:min-h-[90vh] md:min-h-screen",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-800 animate-pulse"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black via-black/80 to-black/40"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/20"}),e.jsx("div",{className:"absolute top-4 sm:top-6 md:top-8 left-4 sm:left-6 md:left-8 z-20",children:e.jsxs(b,{to:"/",className:"inline-flex items-center text-white hover:text-gray-300 active:text-gray-400 transition-colors bg-black/50 backdrop-blur-sm px-3 sm:px-4 py-2 sm:py-2.5 rounded-full touch-manipulation min-h-[44px]",children:[e.jsx(u,{className:"mr-2 w-5 h-5"}),e.jsx("span",{className:"text-base font-medium",children:"Back"})]})}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 md:px-8 py-8 pt-20 sm:pt-24 md:pt-28",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:gap-12",children:[e.jsx("div",{className:"flex-shrink-0 flex justify-center md:justify-start",children:e.jsx("div",{className:"w-56 h-80 sm:w-64 sm:h-96 md:w-72 md:h-[432px] bg-gray-700 animate-pulse rounded-lg"})}),e.jsxs("div",{className:"flex-1 text-white text-center md:text-left",children:[e.jsx("div",{className:"h-12 sm:h-16 md:h-20 bg-gray-700 animate-pulse rounded mb-6 max-w-2xl mx-auto md:mx-0"}),e.jsx("div",{className:"h-6 bg-gray-700 animate-pulse rounded mb-6 max-w-md mx-auto md:mx-0"}),e.jsx("div",{className:"h-4 bg-gray-700 animate-pulse rounded mb-2 max-w-xl mx-auto md:mx-0"}),e.jsx("div",{className:"h-4 bg-gray-700 animate-pulse rounded mb-6 max-w-lg mx-auto md:mx-0"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center md:justify-start",children:[e.jsx("div",{className:"h-12 sm:h-14 w-32 bg-gray-700 animate-pulse rounded-lg"}),e.jsx("div",{className:"h-12 sm:h-14 w-40 bg-gray-700 animate-pulse rounded-lg"})]})]})]})})]})})};export{T as default};
