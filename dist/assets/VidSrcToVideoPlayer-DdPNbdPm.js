const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/streamingService-jLzF5W_z.js","assets/index-CZSZZV6j.js","assets/index-BP79qFqv.css"])))=>i.map(i=>d[i]);
import{r as s,j as e,B as ne,C as se,F as ce,D as ae,s as ie,E as le,_ as de}from"./index-CZSZZV6j.js";import{W as j}from"./watchHistory-BPNt32Ju.js";const ge=({source:h,title:k,onClose:H,isOpen:u,mediaItem:l,mediaType:a,season:v,episode:w,onNextEpisode:b})=>{if(!h)return null;const[g,E]=s.useState(0),[V,U]=s.useState([h]),[M,S]=s.useState(!1),[m,y]=s.useState(!1),[N,A]=s.useState(!1),[I,T]=s.useState(1),[F,P]=s.useState(0),[p,q]=s.useState(0),[X,R]=s.useState(!0),n=s.useRef(null),C=s.useRef(void 0),d=s.useRef(void 0),x=s.useRef(null),G=s.useRef(null);s.useEffect(()=>{if(!u)return;console.log("ðŸš« VidSrc.to Player - Initializing enhanced mobile ad/popup blocking");const r=/iPhone|iPad|iPod|Android|Mobile/i.test(navigator.userAgent);r&&console.log("ðŸ“± VidSrc.to - Mobile device detected, enabling enhanced mobile blocking");const o=window.open,f=window.alert,L=window.confirm,te=window.prompt,z=document.write;window.open=function(...t){return console.log("ðŸš« VidSrc.to - Blocked popup attempt:",t[0]),null},window.alert=function(t){console.log("ðŸš« VidSrc.to - Blocked alert:",t)},window.confirm=function(t){return console.log("ðŸš« VidSrc.to - Blocked confirm:",t),!1},window.prompt=function(t){return console.log("ðŸš« VidSrc.to - Blocked prompt:",t),null},document.write=function(t){if(t&&(t.includes("ad")||t.includes("popup")||t.includes("redirect")||t.includes("aclib")||t.includes("histats")||t.includes("acscdn"))){console.log("ðŸš« VidSrc.to - Blocked document.write with ad content");return}return z.call(document,t)};const W=t=>{console.log("ðŸš« VidSrc.to - Blocked navigation attempt:",t)};try{window.location.assign=function(t){W(t)},window.location.replace=function(t){W(t)}}catch{console.log("ðŸš« VidSrc.to - Could not override location methods (read-only)")}window.addEventListener("beforeunload",t=>{t.preventDefault(),t.returnValue="",console.log("ðŸš« VidSrc.to - Blocked beforeunload redirect")});const _=t=>{const c=t.target;c&&(c.tagName==="A"||c.classList.contains("ad")||c.classList.contains("popup")||c.id.includes("ad")||c.className.includes("ad"))&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),console.log("ðŸš« VidSrc.to - Blocked suspicious click"))},oe=t=>{if(r){const c=t.target;c&&(c.tagName==="A"||c.classList.contains("ad")||c.classList.contains("popup")||c.id.includes("ad")||c.className.includes("ad")||c.getAttribute("href")?.includes("redirect"))&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),console.log("ðŸ“± VidSrc.to - Blocked mobile touch redirect"))}},re=t=>{if(r){const c=t.target;c&&c.tagName==="A"&&(t.preventDefault(),t.stopPropagation(),console.log("ðŸ“± VidSrc.to - Blocked mobile touch link"))}};return document.addEventListener("click",_,!0),r&&(document.addEventListener("touchstart",oe,{passive:!1,capture:!0}),document.addEventListener("touchend",re,{passive:!1,capture:!0}),console.log("ðŸ“± VidSrc.to - Mobile touch blocking enabled")),()=>{window.open=o,window.alert=f,window.confirm=L,window.prompt=te,document.write=z,document.removeEventListener("click",_,!0),console.log("ðŸ§¹ VidSrc.to - Cleaned up popup blocking")}},[u]),s.useEffect(()=>{u&&(async()=>{if(l&&a)try{const{StreamingService:o}=await de(async()=>{const{StreamingService:L}=await import("./streamingService-jLzF5W_z.js");return{StreamingService:L}},__vite__mapDeps([0,1,2])),f=await o.findStreamingSources(l.id.toString(),a,v,w);f.length>0&&U(f)}catch(o){console.error("VidSrc.to - Failed to load additional sources:",o)}})()},[u,l,a,v,w]);const D=()=>{console.log(`VidSrc.to - Source ${g} failed, trying next...`),g<V.length-1?(E(g+1),S(!1)):(S(!0),console.log("VidSrc.to - All sources failed"))},i=V[g]||h;s.useEffect(()=>{if(!u)y(!1),P(0),d.current&&(clearInterval(d.current),d.current=void 0),x.current&&(window.removeEventListener("message",x.current),x.current=null);else if(l&&a){const r=j.getWatchHistory().find(o=>o.id===l.id.toString()&&o.type===a);r&&n.current&&(n.current.currentTime=r.progress,P(r.progress))}},[u,l,a]),s.useEffect(()=>(l&&a&&u&&(h.type==="embed"?(j.updateWatchHistory(l,600,7200,a),d.current=window.setInterval(()=>{const f=600+Date.now()%3600;j.updateWatchHistory(l,f,7200,a)},3e4)):m&&p>0&&(d.current=window.setInterval(()=>{n.current&&p>0&&j.updateWatchHistory(l,n.current.currentTime,p,a)},1e4))),!m&&h.type!=="embed"&&d.current&&(clearInterval(d.current),d.current=void 0),()=>{d.current&&(clearInterval(d.current),d.current=void 0)}),[m,l,a,p,k,u,h.type]);const B=()=>{n.current&&(m?n.current.pause():n.current.play(),y(!m))},J=()=>{n.current&&(n.current.muted=!N,A(!N))},K=r=>{const o=parseFloat(r.target.value);T(o),n.current&&(n.current.volume=o,A(o===0))},Q=()=>{n.current&&P(n.current.currentTime)},Y=()=>{n.current&&q(n.current.duration)},Z=r=>{const o=parseFloat(r.target.value);P(o),n.current&&(n.current.currentTime=o)},$=r=>{const o=Math.floor(r/60),f=Math.floor(r%60);return`${o}:${f.toString().padStart(2,"0")}`},O=()=>{R(!0),C.current&&clearTimeout(C.current),C.current=window.setTimeout(()=>{m&&R(!1)},3e3)},ee=()=>{n.current&&(document.fullscreenElement?document.exitFullscreen():n.current.requestFullscreen())};return u?e.jsx("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onMouseMove:O,children:[e.jsx("button",{onClick:H,className:"absolute top-4 right-4 z-10 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors",children:e.jsx(ne,{className:"w-6 h-6"})}),V.length>1&&e.jsx("div",{className:"absolute top-16 right-4 z-20",children:e.jsx("select",{value:g,onChange:r=>{E(parseInt(r.target.value)),S(!1)},className:"bg-black/70 text-white px-3 py-1 rounded text-sm",children:V.map((r,o)=>e.jsxs("option",{value:o,children:[r.provider," (",r.quality,")"]},o))})}),e.jsx("div",{className:"absolute top-4 left-4 z-10 bg-black/70 text-white px-3 py-2 rounded text-sm",children:"ðŸŽ¬ Stream Plus Player"}),/iPhone|iPad|iPod|Android|Mobile/i.test(navigator.userAgent)&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/90 z-50",children:e.jsxs("div",{className:"text-center text-white p-6",children:[e.jsx("h3",{className:"text-xl mb-4",children:"ðŸ“± Not Available on Mobile"}),e.jsx("p",{className:"mb-4",children:"Stream Plus is not compatible with mobile devices."}),e.jsx("p",{className:"text-sm opacity-75",children:"Please use a desktop browser or try Premium Stream."})]})}),M&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 z-30",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h3",{className:"text-xl mb-4",children:"Media Unavailable"}),e.jsx("p",{className:"mb-4",children:"Stream Plus failed to load this content."}),e.jsx("button",{onClick:()=>{E(0),S(!1)},className:"bg-red-600 hover:bg-red-700 px-4 py-2 rounded",children:"Retry"})]})}),!M&&i.type==="embed"?e.jsx("div",{className:"relative w-full h-full bg-black",children:e.jsx("iframe",{ref:G,src:i.url,className:"w-full h-full border-0",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",referrerPolicy:"unsafe-url",title:`${k} - VidSrc.to Player`,onLoad:()=>{if(console.log("ðŸŽ¬ VidSrc.to iframe loaded:",i.provider,i.url),console.log("ðŸš« VidSrc.to - Enhanced popup blocking active"),S(!1),l&&a&&v&&w&&j.updateWatchHistory(l,0,3600,a,v,w,`S${v}E${w}`),a==="tv"&&b){x.current&&window.removeEventListener("message",x.current);const r=o=>{console.log("VidSrc.to - Received message from iframe:",o.data),o.data&&typeof o.data=="object"&&(o.data.type==="video-ended"||o.data.event==="ended"||o.data.action==="ended"||o.data.message==="video-ended")&&(console.log("VidSrc.to - Video ended message received, auto-advancing to next episode"),b()),typeof o.data=="string"&&(o.data==="video-ended"||o.data==="ended")&&(console.log("VidSrc.to - Video ended string message received, auto-advancing to next episode"),b())};x.current=r,window.addEventListener("message",r),console.log("VidSrc.to - Set up message listener for video end detection")}},onError:r=>{console.error("VidSrc.to - Iframe failed to load:",i.provider,i.url,r),D()}},`vidsrcto-${i.provider}-${g}`)}):M?null:e.jsx("video",{ref:n,src:i.url,className:"w-full h-full object-contain",onTimeUpdate:Q,onLoadedMetadata:Y,onPlay:()=>y(!0),onPause:()=>y(!1),onClick:B,onEnded:()=>{console.log("VidSrc.to - Video ended, checking for next episode"),a==="tv"&&b&&(console.log("VidSrc.to - Auto-advancing to next episode"),b())},onError:r=>{console.error("VidSrc.to - Video error:",r),console.error("VidSrc.to - Video src:",i.url),D()},onLoadStart:()=>console.log("VidSrc.to - Video load started:",i.url),onCanPlay:()=>console.log("VidSrc.to - Video can play:",i.url),onLoadedData:()=>console.log("VidSrc.to - Video data loaded:",i.url),crossOrigin:"anonymous",preload:"metadata"},`vidsrcto-video-${g}`),i.type!=="embed"&&e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-6 transition-opacity duration-300 ${X?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"range",min:"0",max:p||0,value:F,onChange:Z,className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"flex justify-between text-white text-sm mt-1",children:[e.jsx("span",{children:$(F)}),e.jsx("span",{children:$(p)})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:B,className:"p-2 text-white hover:text-gray-300 transition-colors",children:m?e.jsx(se,{className:"w-8 h-8"}):e.jsx(ce,{className:"w-8 h-8"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:J,className:"text-white hover:text-gray-300 transition-colors",children:N?e.jsx(ae,{className:"w-6 h-6"}):e.jsx(ie,{className:"w-6 h-6"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:N?0:I,onChange:K,className:"w-20 h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("span",{className:"text-white font-medium",children:[k," - VidSrc.to"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("button",{onClick:ee,className:"text-white hover:text-gray-300 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})})})]})]}),!i.url&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{children:"Loading VidSrc.to player..."})]})})]})}):null};export{ge as default};
