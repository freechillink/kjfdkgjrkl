import{r as i,j as e,F as Ge,L as Ve,a as Ke,b as Ye,u as Ze,c as Oe,d as Je}from"./index-CZSZZV6j.js";import{m as k,t as J}from"./tmdb-eNF6KsIk.js";import{W as Qe}from"./watchlist-BX-jt4tO.js";import{N as p}from"./NetflixRow-8mwDn4wm.js";import{g as Xe,L as et}from"./LoadingSpinner-De38sLG6.js";import{W as E}from"./watchHistory-BPNt32Ju.js";import"./config-CeCXydgj.js";import"./NetflixCard-mrHihnGq.js";const tt=({featuredItem:t,onPlay:w,onAddToWatchlist:x})=>{const[v,y]=i.useState(!1),[d,N]=i.useState(!1),[T,L]=i.useState(!1),m=h=>h?h.startsWith("http")?h:`https://image.tmdb.org/t/p/original${h}`:"/placeholder-backdrop.jpg",Q=()=>"name"in t?`/tv/${t.id}`:`/movie/${t.id}`,P=()=>"name"in t?t.name:t.title,I=()=>{const h="first_air_date"in t?t.first_air_date:t.release_date;return h?new Date(h).getFullYear():""},R=()=>{x&&(x(),N(!0),setTimeout(()=>N(!1),2e3))},X=()=>{L(!0),setTimeout(()=>{w()},800)};return e.jsxs("div",{className:"relative h-[70vh] mobile:h-[80vh] md:h-screen flex items-center justify-start overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:m(t.backdrop_path||""),alt:P(),className:`w-full h-full object-cover transition-all duration-1000 ${v?"opacity-100":"opacity-0"} ${T?"animate-zoom-in":""}`,onLoad:()=>y(!0)}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black via-black/70 to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent"})]}),e.jsxs("div",{className:"relative z-10 max-w-2xl mx-4 mobile:mx-6 md:ml-12 lg:ml-16 xl:ml-20",children:[e.jsx("h1",{className:"text-2xl mobile:text-3xl sm:text-4xl md:text-6xl lg:text-7xl font-bold text-white mb-3 mobile:mb-4 leading-tight",children:P()}),t.overview&&e.jsx("p",{className:"text-sm mobile:text-base md:text-lg lg:text-xl text-gray-200 mb-6 mobile:mb-8 leading-relaxed max-w-xl line-clamp-3",children:t.overview}),e.jsxs("div",{className:"flex items-center space-x-2 mb-6 mobile:mb-8 text-white",children:[I()&&e.jsx("span",{className:"text-sm mobile:text-base md:text-lg font-semibold",children:I()}),t.vote_average&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-yellow-400",children:"★"}),e.jsx("span",{className:"text-sm mobile:text-base md:text-lg",children:t.vote_average.toFixed(1)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mobile:space-x-4",children:[e.jsxs("button",{onClick:X,className:"flex items-center space-x-1 mobile:space-x-2 bg-white text-black px-4 mobile:px-6 md:px-8 py-2 mobile:py-3 rounded-md font-bold text-sm mobile:text-base md:text-lg hover:bg-gray-200 transition-all duration-200 transform hover:scale-105 active:scale-95 min-h-[44px] shadow-lg",children:[e.jsx(Ge,{className:"w-4 h-4 mobile:w-5 mobile:h-5 md:w-6 md:h-6"}),e.jsx("span",{children:"Play"})]}),e.jsxs(Ve,{to:Q(),className:"flex items-center space-x-1 mobile:space-x-2 bg-gray-600 bg-opacity-70 text-white px-4 mobile:px-6 md:px-8 py-2 mobile:py-3 rounded-md font-bold text-sm mobile:text-base md:text-lg hover:bg-opacity-90 transition-all duration-200 transform hover:scale-105 active:scale-95 min-h-[44px] backdrop-blur-sm",children:[e.jsx(Ke,{className:"w-4 h-4 mobile:w-5 mobile:h-5 md:w-6 md:h-6"}),e.jsx("span",{className:"hidden mobile:inline",children:"More Info"}),e.jsx("span",{className:"mobile:hidden",children:"Info"})]}),e.jsx("button",{onClick:R,className:`flex items-center justify-center w-10 h-10 mobile:w-12 mobile:h-12 rounded-full transition-all duration-300 transform hover:scale-110 active:scale-95 min-h-[44px] min-w-[44px] backdrop-blur-sm ${d?"bg-green-600 text-white scale-125 animate-pulse":"bg-gray-600 bg-opacity-70 text-white hover:bg-opacity-90 hover:bg-[#e50914]"}`,title:d?"Added to My List!":"Add to My List",children:d?e.jsx("svg",{className:"w-4 h-4 mobile:w-5 mobile:h-5 md:w-6 md:h-6",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):e.jsx(Ye,{className:"w-4 h-4 mobile:w-5 mobile:h-5 md:w-6 md:h-6"})})]})]})]})},st=({progress:t,className:w="",showPercentage:x=!1,size:v="md"})=>{const y={sm:"h-1",md:"h-2",lg:"h-3"},d=Math.max(0,Math.min(100,t));return e.jsxs("div",{className:`relative ${w}`,children:[e.jsx("div",{className:`w-full bg-gray-600 bg-opacity-50 rounded-full overflow-hidden ${y[v]}`,children:e.jsx("div",{className:"h-full bg-[#e50914] transition-all duration-300 ease-out rounded-full",style:{width:`${d}%`}})}),x&&e.jsx("div",{className:"absolute -top-6 right-0",children:e.jsxs("span",{className:"text-xs text-gray-400 font-medium",children:[Math.round(d),"%"]})})]})},at=({item:t,showProgress:w=!0,onRemove:x})=>{const{isMobile:v,isTablet:y,isTV:d}=Ze(),N=t.progress/t.duration*100,T=()=>{const m="group relative bg-gray-900 rounded-md overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 flex-shrink-0 cursor-pointer transform-gpu";return d?`${m} hover:scale-110 focus:scale-110 w-96 aspect-video`:y?`${m} hover:scale-105 active:scale-95 w-80 aspect-video`:v?`${m} active:scale-95 w-64 aspect-video`:`${m} hover:scale-105 w-80 aspect-video`},L=()=>d?"text-xl":y?"text-lg":v?"text-base":"text-lg";return e.jsxs("div",{className:T(),children:[e.jsxs(Ve,{to:`/${t.type}/${t.id}`,className:"block h-full relative",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:Xe(t.backdrop_path||t.poster_path),alt:t.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/80 via-black/40 to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-black/20"})]}),e.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-between p-3 sm:p-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"bg-black/60 backdrop-blur-sm text-white px-2 py-1 rounded text-xs font-medium",children:t.type==="movie"?"🎬":"📺"}),t.completed&&e.jsx("div",{className:"bg-[#e50914] text-white px-2 py-1 rounded text-xs font-bold",children:"✓ WATCHED"})]}),e.jsxs("div",{className:"space-y-2",children:[t.season&&t.episode&&e.jsx("div",{className:"inline-flex items-center",children:e.jsxs("span",{className:"bg-gray-800/80 text-gray-300 px-2 py-1 rounded-md text-xs font-medium border border-gray-700/50",children:["S",t.season,"E",t.episode]})}),e.jsx("h3",{className:`font-bold text-white line-clamp-2 group-hover:text-[#e50914] transition-colors duration-200 ${L()}`,children:t.title}),w&&t.progress>0&&e.jsx("div",{className:"space-y-1",children:e.jsx(st,{progress:N,size:"sm",className:"h-1"})})]})]})]}),x&&e.jsx("button",{onClick:m=>{m.preventDefault(),x(t.id,t.type)},className:"absolute top-2 right-2 bg-black/60 backdrop-blur-sm text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 mobile:opacity-100 transition-opacity hover:bg-red-600 z-20 flex items-center justify-center",title:"Remove from history",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},ut=()=>{const{t}=Oe(),w=Je(),[x,v]=i.useState([]),[y,d]=i.useState([]),[N,T]=i.useState([]),[L,m]=i.useState([]),[Q,P]=i.useState([]),[I,R]=i.useState([]),[X,h]=i.useState([]),[De,ee]=i.useState([]),[ke,te]=i.useState([]),[Le,se]=i.useState([]),[ge,A]=i.useState([]),[_,Pe]=i.useState([]),[l,pe]=i.useState(null),[Re,xe]=i.useState(!0),[ve,fe]=i.useState(null),[We,ye]=i.useState(!1),$e=()=>{console.log("🔄 Manually refreshing Continue Watching section...");const s=E.getContinueWatching();A(s),console.log(`✅ Continue Watching updated: ${s.length} items`)};if(i.useEffect(()=>{const s=()=>{console.log("🔄 Received refresh event, updating Continue Watching..."),$e()};return window.addEventListener("refreshContinueWatching",s),()=>{window.removeEventListener("refreshContinueWatching",s)}},[]),i.useEffect(()=>{const s=async()=>{try{xe(!0),fe(null);const b=E.getContinueWatching();A(b),console.log("Continue Watching loaded:",b.length,"items");const r=async(n,c=3)=>{const a=[];for(let u=1;u<=c;u++)a.push(n(u));return(await Promise.all(a)).flatMap(u=>u.data.results||[])},[be,we,He,je,Ne]=await Promise.all([r(k.getPopular,3),r(k.getTopRated,3),r(k.getNowPlaying,3),r(J.getPopular,3),r(J.getTopRated,3)]);let B=[],G=[],K=[],W=[],Y=[];try{console.log("🎬 Fetching enhanced genre-specific content for Home page..."),[B,G,K,W,Y]=await Promise.all([r(k.getComedy,6).catch(()=>[]),r(k.getDrama,6).catch(()=>[]),r(k.getHorror,5).catch(()=>[]),r(J.getComedy,8).catch(()=>[]),r(J.getDrama,6).catch(()=>[])]),console.log("🎬 Home genre content fetched:",{comedyMovies:B.length,dramaMovies:G.length,horrorMovies:K.length,comedyTVShows:W.length,dramaTVShows:Y.length})}catch(n){console.warn("Genre API calls failed, using fallback content:",n)}const $=new Set,ae=(n,c=100)=>{const a=[];for(const o of n)!$.has(o.id)&&a.length<c&&($.add(o.id),a.push(o));return a},Te=(n,c=100)=>{const a=[];for(const o of n)!$.has(o.id)&&a.length<c&&($.add(o.id),a.push(o));return a},q=ae(be||[],80),M=Te(je||[],80),F=ae(we||[],80),S=Te(Ne||[],80),Me=ae(He||[],80),Z=new Set,oe=(n,c=100)=>{const a=[];for(const o of n)!Z.has(o.id)&&a.length<c&&(Z.add(o.id),a.push(o));return a},Se=(n,c=100)=>{const a=[];for(const o of n)!Z.has(o.id)&&a.length<c&&(Z.add(o.id),a.push(o));return a},Ue=oe(B||[],100),Ee=oe(G||[],100),Ie=oe(K||[],100);let C=Se(W||[],100),Ae=Se(Y||[],100);if(C.length<20){console.log("🎭 Comedy TV fallback: Using popular TV shows filtered by comedy keywords");const n=["comedy","funny","humor","sitcom","comic"],c=[...M,...S].filter(a=>{const o=(a.name||a.title||"").toLowerCase(),u=(a.overview||"").toLowerCase();return n.some(D=>o.includes(D)||u.includes(D))}).slice(0,50);C=[...C,...c].filter((a,o,u)=>u.findIndex(D=>D.id===a.id)===o).slice(0,100)}console.log("📺 Skipping image validation - showing all content with fallback handling in components"),v(q),d(M),T(F),m(S),P(Me),R(Ue),h(Ee),ee(Ie),te(C),se(Ae),console.log("🎭 Comedy TV Shows Debug:",{rawComedyTVData:W.length,uniqueComedyTVShows:C.length,sampleTitles:C.slice(0,5).map(n=>n.name||n.title)});const V=[...q,...F,...Me,...B,...G,...K],z=[...M,...S,...W,...Y];V.length>0&&console.log("Sample movie data:",V[0]),z.length>0&&console.log("Sample TV show data:",z[0]);const H=(n,c,a=50)=>{const o=new Set,u=["994682"],D=["sexy","oral","adult","xxx","porn","erotic","nude"],_e=["xxx","coraline"];return n.filter(f=>{if(u.includes(String(f.id))||o.has(f.id))return!1;const me=(f.title||f.name||"").toLowerCase(),Be=(f.overview||"").toLowerCase();return!_e.includes(me)&&D.some(he=>me.includes(he))?!1:c.some(he=>{const j=he.toLowerCase();return me.includes(j)||Be.includes(j)?!0:f.genre_ids&&Array.isArray(f.genre_ids)?f.genre_ids.some(ue=>{const O=String(ue),Ce=typeof ue=="string"?ue.toLowerCase():O.toLowerCase();return j==="comedy"&&O==="35"||j==="drama"&&O==="18"||j==="horror"&&O==="27"?!0:Ce.includes(j)||j.includes(Ce)}):!1})?(o.add(f.id),!0):!1}).slice(0,a)},ie=H(V,["comedy","humor","funny","comic","laugh","hilarious","parody","satire","fun","amusing","witty"],100),ne=H(V,["drama","dramatic","emotional","family","relationship","romance","love","life","story"],100),le=H(V,["horror","scary","thriller","terror","frightening","suspense","dark","creepy","nightmare"],100),re=H(z,["comedy","humor","funny","comic","laugh","hilarious","sitcom","fun","amusing","witty"],100),ce=H(z,["drama","dramatic","emotional","family","relationship","romance","love","life","story","series"],100);R(ie),h(ne),ee(le),te(re),se(ce),console.log("🏠 Home page genre rows final counts:",{comedyMovies:ie.length,dramaMovies:ne.length,horrorMovies:le.length,comedyTVShows:re.length,dramaTVShows:ce.length,totalContentPool:{movies:V.length,tvShows:z.length}}),console.log("Home: Data Loading Results:",{originalData:{popularMovies:be.length,topRatedMovies:we.length,popularTV:je.length,topRatedTV:Ne.length},uniqueData:{popularMovies:q.length,topRatedMovies:F.length,popularTV:M.length,topRatedTV:S.length},totalUniqueItems:$.size,genreData:{comedyMovies:ie.length,dramaMovies:ne.length,horrorMovies:le.length,comedyTVShows:re.length,dramaTVShows:ce.length}});const U=[];q.length>0&&U.push(...q.slice(0,5)),M.length>0&&U.push(...M.slice(0,5)),F.length>0&&U.push(...F.slice(0,5)),S.length>0&&U.push(...S.slice(0,5));const de=U.sort(()=>Math.random()-.5);Pe(de),de.length>0&&pe(de[0])}catch(b){console.error("Error fetching data from Strem.io:",b),fe("Failed to load content. Please try again later."),v([]),d([]),T([]),m([]),P([]),R([]),h([]),ee([]),te([]),se([])}finally{xe(!1)}},g=()=>{document.hidden||A(E.getContinueWatching())};return s(),document.addEventListener("visibilitychange",g),()=>document.removeEventListener("visibilitychange",g)},[]),i.useEffect(()=>{if(_.length<=1)return;let s=0;const g=setInterval(()=>{ye(!0),setTimeout(()=>{s=(s+1)%_.length,pe(_[s]),setTimeout(()=>{ye(!1)},100)},500)},8e3);return()=>clearInterval(g)},[_]),Re)return e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx(et,{size:"lg"})});const qe=(s,g)=>{E.removeFromHistory(s,g),A(E.getContinueWatching())},Fe=async()=>{if(l)try{const s="name"in l?"tv":"movie",g="name"in l?l.name:l.title,b=new URLSearchParams({type:s,title:g,provider:"vidsrc"});s==="tv"&&(b.set("season","1"),b.set("episode","1"));const r=`/player/${l.id}?${b.toString()}`;w(r),console.log(`🎬 Home - Playing featured ${s}: ${g}`),console.log(`🚀 Home - Navigating to: ${r}`)}catch(s){console.error("Error loading featured item:",s)}},ze=()=>{if(l)try{const s="name"in l?"tv":"movie";Qe.addToWatchlist(l,s)&&console.log("Added to watchlist:","name"in l?l.name:l.title)}catch(s){console.error("Error adding to watchlist:",s)}};return e.jsxs("div",{className:"min-h-screen",children:[ve&&e.jsx("div",{className:"bg-red-900 border-l-4 border-red-500 p-4 relative z-50",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-200",children:ve})})]})})}),l&&e.jsx("div",{className:"relative",children:e.jsx("div",{className:`transition-opacity duration-500 ease-in-out ${We?"opacity-0":"opacity-100"}`,children:e.jsx(tt,{featuredItem:l,onPlay:Fe,onAddToWatchlist:ze})})}),e.jsxs("div",{className:"relative z-10 space-y-6 mobile:space-y-8 px-2 mobile:px-4 md:px-12 overflow-visible",children:[ge.length>0&&e.jsxs("div",{className:"animate-fade-in mb-6 mobile:mb-4",children:[e.jsx("h2",{className:"text-white font-semibold mb-3 mobile:mb-2 px-2 mobile:px-3 sm:px-4 text-base xs:text-lg sm:text-xl",children:"Continue Watching"}),e.jsx("div",{className:"relative group overflow-visible",children:e.jsx("div",{className:"overflow-x-auto overflow-y-visible scrollbar-hide pb-6 pt-6 -mt-2 -mb-2 flex items-start px-2 gap-2 xs:gap-3 sm:px-4 sm:gap-4",style:{scrollBehavior:"smooth",WebkitOverflowScrolling:"touch",scrollSnapType:"x mandatory"},children:ge.map(s=>e.jsx("div",{className:"scroll-snap-align-start relative z-10 hover:z-20",children:e.jsx(at,{item:s,showProgress:!0,onRemove:qe})},`${s.type}-${s.id}`))})})]}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.2s"},children:e.jsx(p,{title:t.popularMovies,items:x})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.3s"},children:e.jsx(p,{title:t.popularTVShows,items:y})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.4s"},children:e.jsx(p,{title:t.topRated,items:N})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.5s"},children:e.jsx(p,{title:t.topRated,items:L})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.6s"},children:e.jsx(p,{title:t.nowPlaying,items:Q})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.7s"},children:e.jsx(p,{title:"Comedy Movies",items:I})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.8s"},children:e.jsx(p,{title:"Drama Movies",items:X})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.9s"},children:e.jsx(p,{title:"Horror Movies",items:De})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"1.0s"},children:e.jsx(p,{title:"Comedy TV Shows",items:ke})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"1.1s"},children:e.jsx(p,{title:"Drama TV Shows",items:Le})})]})]})};export{ut as default};
